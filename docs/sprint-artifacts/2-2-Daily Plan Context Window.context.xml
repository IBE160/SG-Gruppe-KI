<story-context id="2-2-daily-plan-context-window" v="1.1">
  <metadata>
    <epicId>2</epicId>
    <storyId>2</storyId>
    <title>Daily Plan Context Window</title>
    <status>ready-for-dev</status>
    <generatedAt>2025-12-15</generatedAt>
    <generator>BMAD Story Context Workflow (Regenerated)</generator>
    <sourceStoryPath>docs/sprint-artifacts/2-2-Daily Plan Context Window.md</sourceStoryPath>
  </metadata>
  <story>
    <asA>user</asA>
    <iWant>to input my daily mood, energy, and soreness levels via a Context Window</iWant>
    <soThat>the AI can adapt my daily workout plan accordingly.</soThat>
    <tasks>
      - [ ] **Task 1: Implement Context Window UI Component (AC: 1, 2, 3, 4, 5)**
      - [ ] **Task 2: Implement Context Window State Management**
      - [ ] **Task 3: Implement Context Submission Logic (AC: 6, 7)**
      - [ ] **Task 4: E2E Testing**
    </tasks>
  </story>
  <acceptanceCriteria>
    <criterion>AC2.2.1: A "Context Window" UI is available on the dashboard for the user to input mood, energy, and soreness.</criterion>
    <criterion>AC2.2.2: Submitting the context triggers a call to the /plans/generate endpoint.</criterion>
  </acceptanceCriteria>
  <artifacts>
    <docs>
        <doc>
            <path>docs/architecture.md</path>
            <title>Architecture</title>
            <section>Novel Architectural Patterns</section>
            <snippet>Pattern: Adaptive Workout Dialogue - This pattern formalizes the conversational loop between the user and the AI, ensuring the AI's adaptations are transparent, effective, and continuously learning.</snippet>
        </doc>
        <doc>
            <path>docs/ux-design-direction.md</path>
            <title>UX Design Direction</title>
            <section>Flow 6: Generate AI Daily Plan</section>
            <snippet>The UI for the Plan Review should be based on Flow 6, Screen 3 - screen_3/code.html from ux_design_content.</snippet>
        </doc>
    </docs>
    <code>
      <!-- No existing code artifacts found relevant to this story. -->
    </code>
  </artifacts>
  <constraints>
    <constraint>Strict adherence to the UX design specifications for the Context Window (Flow 6, Screen 1).</constraint>
    <constraint>Frontend-Backend Contract: context data sent to POST /plans/generate must match backend's expected Pydantic model.</constraint>
  </constraints>
  <interfaces>
    <interface>
      <name>Daily Plan Generation API</name>
      <kind>REST endpoint</kind>
      <signature>POST /plans/generate</signature>
      <path>apps/api/app/api/plans.py</path>
    </interface>
  </interfaces>
  <tests>
      <standards>Frontend: Unit tests (Jest/RTL) for Context Window component, verifying UI rendering and interaction with input fields. Unit tests for Zustand store. Integration tests for submission logic, mocking API call. E2E test (Playwright) for full user journey.</standards>
      <locations><location>apps/web/tests</location></locations>
      <ideas>
          <idea>Unit test ContextWindow.tsx for correct rendering of input fields (mood, energy, soreness).</idea>
          <idea>E2E test user interaction with the Context Window and successful submission of data.</idea>
      </ideas>
  </tests>
</story-context>