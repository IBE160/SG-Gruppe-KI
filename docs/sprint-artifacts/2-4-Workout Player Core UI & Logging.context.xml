<story-context id="2-4-workout-player-core-ui-logging" v="1.0">
  <metadata>
    <epicId>2</epicId>
    <storyId>4</storyId>
    <title>Workout Player Core UI & Logging</title>
    <status>ready-for-dev</status>
    <generatedAt>2025-12-15</generatedAt>
    <generator>BMAD Story Context Workflow (Regenerated)</generator>
    <sourceStoryPath>docs/sprint-artifacts/2-4-Workout Player Core UI & Logging.md</sourceStoryPath>
  </metadata>
  <story>
    <asA>user</asA>
    <iWant>an intuitive interface to perform and log my workout sets (reps, weight, RPE) in real-time</iWant>
    <soThat>I can accurately track my progress.</soThat>
    <tasks>
      - [ ] **Task 1: Implement Workout Player UI Shell & Start Logic (AC: 1, 2, 3, 9)**
      - [ ] **Task 2: Implement Set Logging UI & State (AC: 4)**
      - [ ] **Task 3: Implement Rest Timer & Navigation (AC: 5)**
      - [ ] **Task 4: Implement Backend `POST /logs` Endpoint (AC: 6, 7)**
      - [ ] **Task 5: Implement Offline Persistence for Workout State (AC: 8)**
      - [ ] **Task 6: E2E Testing**
    </tasks>
  </story>
  <acceptanceCriteria>
    <criterion>AC2.4.1: A "Start Workout" button is available (e.g., on the Dashboard or Plan Review screen) which initiates the Workout Player UI.</criterion>
    <criterion>AC2.4.2: The UI allows users to log reps, weight, and RPE for each set.</criterion>
    <criterion>AC2.4.3: Logged data is sent to the `POST /logs` endpoint and stored in the `WorkoutLogs` table.</criterion>
  </acceptanceCriteria>
  <artifacts>
    <docs>
        <doc>
            <path>docs/architecture.md</path>
            <title>Architecture</title>
            <section>Novel Architectural Patterns</section>
            <snippet>This story directly implements the interactive component of the "Adaptive Workout Dialogue" pattern, enabling real-time data capture.</snippet>
        </doc>
        <doc>
            <path>docs/ux-design-direction.md</path>
            <title>UX Design Direction</title>
            <section>Flow 7: Start Workout</section>
            <snippet>The UI for the Workout Player should be based on Flow 7: Start Workout and Flow 9: Perform & Log Workout sections...</snippet>
        </doc>
    </docs>
    <code>
      <!-- No existing code artifacts found relevant to this story. -->
    </code>
  </artifacts>
  <constraints>
    <constraint>UI interactions within the workout player (e.g., logging a set) must feel instantaneous, with feedback appearing in < 200ms.</constraint>
    <constraint>The frontend must persist the active workout state in local storage to prevent data loss if the user accidentally closes the tab or the browser crashes.</constraint>
  </constraints>
  <interfaces>
      <interface>
        <name>Log Workout</name>
        <kind>REST Endpoint</kind>
        <signature>POST /logs</signature>
        <path>apps/api/app/api/logs.py</path>
      </interface>
  </interfaces>
  <tests>
      <standards>Jest/React Testing Library for frontend UI, Pytest for backend API and service logic, Playwright for E2E tests covering real-time logging.</standards>
      <locations><location>apps/web/src/app/workout/player/</location></locations>
      <ideas>
          <idea>Unit test `SetLogger` component for optimized input controls and real-time logging.</idea>
          <idea>E2E test the flow of starting a workout, logging multiple sets, and verifying data persistence and synchronization.</idea>
      </ideas>
  </tests>
</story-context>